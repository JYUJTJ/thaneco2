<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>عيد مبارك | تهنئة خاصة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            min-height: 100vh;
            background: linear-gradient(145deg, #0b2a35 0%, #1b4a5a 70%, #2c6b7e 100%);
            font-family: 'Amiri', 'Traditional Arabic', 'Scheherazade New', 'Tahoma', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow-x: hidden;
            direction: rtl;
            padding: 15px;
        }
        .floating-icons { position: absolute; width:100%; height:100%; top:0; left:0; pointer-events:none; z-index:1; overflow:hidden; }
        .floating-icons i { position:absolute; color: rgba(255,235,150,0.8); user-select:none; filter: drop-shadow(0 0 8px #ffb347); transition: top 10s ease, left 10s ease; }
        @keyframes fadeInOut { 0%{opacity:0} 20%{opacity:1} 80%{opacity:1} 100%{opacity:0} }

        .eid-card {
            position: relative; z-index: 10; max-width: 720px; width: 100%;
            background: rgba(255,255,255,0.1); backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 2px solid rgba(255,245,170,0.5);
            border-radius: 60px 60px 30px 30px;
            box-shadow: 0 30px 50px rgba(0,0,0,0.4), 0 0 0 2px rgba(250,235,140,0.2) inset, 0 0 30px #f9e57c80;
            padding: 35px 30px 45px; text-align:center;
        }
        .greeting-container { display:flex; flex-direction:column; align-items:center; gap:15px; }

        .moon-image { max-width:280px; width:100%; border-radius:40px; background: rgba(255,255,245,0.15); padding:15px 20px 10px; box-shadow:0 0 30px #ffd966b3; border:1px solid #ffdf9e; transition: transform .4s ease; }
        .moon-image:hover { transform:scale(1.02); box-shadow:0 0 45px #ffc107; }
        .moon-image img { max-width:100%; height:auto; display:block; margin:0 auto; border-radius:20px; filter: drop-shadow(0 8px 15px #00000040); }

        .main-greeting { font-size:3.2rem; font-weight:700; color:#fef7e6; text-shadow:0 2px 10px #c98f35, 0 0 20px #fbbc04; line-height:1.3; margin:5px 0; }
        .sender-box { background: rgba(44,68,58,0.6); backdrop-filter: blur(5px); border:1px solid #f9d77e; border-radius:60px; padding:5px 30px; display:inline-flex; align-items:center; gap:10px; box-shadow:0 0 25px #fbc84b; margin:5px 0 15px; font-size:2rem; }
        .sender-box span:first-child { color:#fcf3da; font-size:1.8rem; opacity:0.9; }
        .sender-name { font-size:2.5rem; font-weight:bold; color:#ffec9e; }

        .blessing-text { font-size:1.8rem; color:#fcf3da; background: rgba(0,0,0,0.1); padding:15px 25px; border-radius:50px; margin:20px 0 10px; line-height:1.7; border:1px solid #ffd78c; }
        .decorative-line { display:flex; align-items:center; justify-content:center; gap:20px; margin:25px 0 10px; }
        .decorative-line i { font-size:2rem; color:#f9da94; }

        .custom-message { font-size:1.2rem; color:#fef7e6; margin-top:15px; background: rgba(0,0,0,0.1); padding:10px 20px; border-radius:30px; text-align:center; border:1px solid #ffd78c; }

        .footer-dua { font-size:1.4rem; color:#dfd7b6; margin-top:25px; background: rgba(0,0,0,0.2); padding:10px 20px; border-radius:40px; display:inline-block; border:1px solid #e1b95b; }

        /* ad containers */
        .ad-container { margin: 18px auto; width: 100%; max-width: 300px; height: 250px; display:flex; align-items:center; justify-content:center; }
        .ad-footer { margin-top:14px; max-width:320px; height:50px; }

        @media (max-width:500px){ .main-greeting{font-size:2.5rem} .sender-box{font-size:1.5rem;padding:5px 20px} .sender-name{font-size:2rem} .blessing-text{font-size:1.4rem} .ad-container{max-width:320px;height:50px} }

        .back-button-container { position:fixed; bottom:20px; left:50%; transform:translateX(-50%); z-index:20; display:flex; gap:12px; align-items:center; }
        .back-button { background: rgba(255,255,255,0.1); border:2px solid rgba(255,245,170,0.5); border-radius:50px; padding:10px 20px; color:#fef7e6; font-size:1.1rem; cursor:pointer; }
        .message-box { position:relative; z-index:10; max-width:400px; width:100%; background: rgba(255,255,255,0.1); backdrop-filter: blur(12px); border:2px solid rgba(255,245,170,0.5); border-radius:30px; padding:30px; text-align:center; cursor:pointer; transition: transform .3s ease; }
        .message-box:hover { transform:scale(1.03); }
        .envelope{ font-size:4rem; color:#fef7e6; margin-bottom:15px; text-shadow:0 2px 10px #c98f35; }
        .message-text{ font-size:1.8rem; color:#fef7e6; text-shadow:0 2px 10px #c98f35; }
    </style>
</head>
<body>

    <div class="floating-icons">
        <i class="fas fa-star" style="top:5%; left:10%; font-size:3rem; animation: fadeInOut 10s infinite; animation-delay: 0s;"></i>
        <i class="fas fa-moon" style="top:12%; left:85%; font-size:4rem; animation: fadeInOut 10s infinite; animation-delay: 1s;"></i>
        <i class="fas fa-star" style="top:22%; left:25%; font-size:2.2rem; animation: fadeInOut 10s infinite; animation-delay: 2s;"></i>
        <!-- more icons omitted for brevity -->
    </div>

    <!-- صندوق الرسالة المغلق -->
    <div id="message-box" class="message-box" onclick="openMessage()">
        <div class="envelope"><i class="fas fa-envelope"></i></div>
        <div class="message-text"><i class="fas fa-star"></i> انقر للفتح! <i class="fas fa-star"></i></div>
    </div>

    <!-- بطاقة التهنئة (مخفية حتى الضغط) -->
    <div class="eid-card" id="eid-card" style="display:none;">
        <div class="greeting-container">

            <div class="moon-image">
                <img src="https://png.pngtree.com/png-clipart/20230317/original/pngtree-ramadan-eid-al-fitr-mubarak-or-adha-islamic-calligraphy-with-moon-png-image_8993503.png" alt="عيد مبارك - هلال">
            </div>

            <!-- إعلان مركزي غير مزعج - يُحمَّل بعد الفتح -->
            <div id="ad-top" class="ad-container" aria-hidden="true"></div>

            <div class="main-greeting"><i class="fas fa-star"></i> عيد مبارك <i class="fas fa-star"></i></div>

            <div class="sender-box"><span>من</span> <span class="sender-name" id="sender-name">{{name}}</span></div>

            <div class="blessing-text">
                <i class="fas fa-heart"></i>
                كل عام وأنتم بخير، أعاده الله علينا وعليكم باليمن والبركات، وتقبل الله صالح الأعمال
                <i class="fas fa-heart"></i>
            </div>

            <div class="decorative-line"><i class="fas fa-star"></i><span></span><i class="fas fa-lantern"></i><span></span><i class="fas fa-star"></i></div>

            <div class="custom-message" id="custom-message">{{message}}</div>

            <div class="decorative-line"><i class="fas fa-star"></i><span></span><i class="fas fa-lantern"></i><span></span><i class="fas fa-star"></i></div>

            <!-- إعلان سفلي صغير (موبايل) -->
            <div id="ad-footer" class="ad-container ad-footer" aria-hidden="true"></div>

            <div class="footer-dua"><i class="fas fa-hands-praying"></i> عيد سعيد و أيام مليئة بالفرح <i class="fas fa-hands-praying"></i></div>
        </div>
    </div>

    <!-- مشغل الصوت (مخفي) -->
    <audio style="display:none;">
        <source src="7ter_Ya_Aid.mp3" type="audio/mpeg">
    </audio>

    <div class="back-button-container">
        <div class="custom-message"><i class="fas fa-star"></i> مطور : أ. عمرو أحمد محمد <i class="fas fa-star"></i></div>
        <button class="back-button" onclick="window.location.href='index.html'"><i class="fas fa-plus-circle"></i> أنشئ تهنئة باسمك</button>
    </div>

    <script>
        // flags to avoid injecting ads multiple times
        let adsInjected = false;

        // helper to inject HPF (highperformanceformat) iframe ad with atOptions
        function injectHPF(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            // create inline script that sets atOptions
            const s1 = document.createElement('script');
            s1.type = 'text/javascript';
            s1.text = "atOptions = { 'key' : '927e5c12672a735c8698e4e7d901cbfb', 'format' : 'iframe', 'height' : 250, 'width' : 300, 'params' : {} };";
            // create script to load provider
            const s2 = document.createElement('script');
            s2.src = "https://www.highperformanceformat.com/927e5c12672a735c8698e4e7d901cbfb/invoke.js";
            s2.async = true;
            // empty container then append
            container.innerHTML = "";
            container.appendChild(s1);
            container.appendChild(s2);
            container.setAttribute('aria-hidden', 'false');
        }

        // helper to inject EffectiveGate CPM script (for footer / mobile)
        function injectEffective(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            const s = document.createElement('script');
            s.src = "https://pl28745109.effectivegatecpm.com/40/2e/03/402e03d5a1f8904c4d1df3bce6b62e37.js";
            s.async = true;
            container.innerHTML = "";
            container.appendChild(s);
            container.setAttribute('aria-hidden', 'false');
        }

        // main open function (same logic: عند الضغط تظهر البطاقة)
        function openMessage() {
            // hide closed box
            const box = document.getElementById('message-box');
            if (box) box.style.display = 'none';

            // show card
            const card = document.getElementById('eid-card');
            if (card) card.style.display = 'block';

            // set name & message from URL params (if موجودة)
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name') || 'الصائم';
            const message = urlParams.get('message') || 'تقبل الله صيامكم وقيامكم';

            const senderEl = document.getElementById('sender-name');
            if (senderEl) senderEl.textContent = name;

            const msgEl = document.getElementById('custom-message');
            if (msgEl) msgEl.innerHTML = `<i class="fas fa-star"></i> ${escapeHtml(message)} <i class="fas fa-star"></i>`;

            // inject ads once, after card is visible (prevents hidden-load issues)
            if (!adsInjected) {
                // inject a central banner (300x250)
                injectHPF('ad-top');
                // inject a footer/mobile ad (smaller)
                injectEffective('ad-footer');
                adsInjected = true;
            }
        }

        // small helper to escape HTML in message param
        function escapeHtml(unsafe) {
            return String(unsafe)
              .replace(/&/g, "&amp;")
              .replace(/</g, "&lt;")
              .replace(/>/g, "&gt;")
              .replace(/"/g, "&quot;")
              .replace(/'/g, "&#039;");
        }

        // Optional: if URL contains name/message and you want to auto-open, uncomment:
        // window.addEventListener('load', function(){
        //     const p = new URLSearchParams(window.location.search);
        //     if (p.get('name') || p.get('message')) openMessage();
        // });
    </script>
</body>
</html>
